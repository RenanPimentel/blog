(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{67:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(31),c=a.n(r),s=a(6),i=a(4),l=a(15),o=a(3),u=a.n(o),j=a(7),d=a(2),b=a(32),m=a.n(b).a.create({baseURL:"http://localhost:4000/api/v1",withCredentials:!0});function h(e,t){if("SET_ME"===t.type)return Object(l.a)(Object(l.a)({},e),{},{me:t.payload});throw new Error("reducer couldn't find it")}var x=a(0),O=Object(n.createContext)({}),v={me:{}};function f(e){var t=e.children,a=Object(n.useReducer)(h,v),r=Object(d.a)(a,2),c=r[0],s=r[1],i=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.get("/logout");case 2:location.assign("/me");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=Object(l.a)({defaultAvatar:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ficon-library.com%2Fimages%2Fdefault-profile-icon%2Fdefault-profile-icon-16.jpg&f=1&nofb=1",defaultBanner:"https://images.unsplash.com/photo-1622988869811-a4f3d3fe5441?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=634&q=80",logout:i,setMe:function(e){s({type:"SET_ME",payload:e})}},c);return Object(x.jsx)(O.Provider,{value:o,children:t})}var p=function(){var e=Object(n.useContext)(O),t=e.logout,a=e.me,r=e.defaultAvatar;return Object(x.jsx)("div",{className:"nav-user",children:Object(x.jsxs)("div",{className:"profile-container",children:[Object(x.jsx)("div",{className:"profile-picture",children:Object(x.jsx)("img",{src:a.avatar||r,alt:"your profile"})}),Object(x.jsx)("div",{className:"container-wrapper",children:Object(x.jsxs)("div",{className:"profile-settings",children:[Object(x.jsxs)("li",{children:[Object(x.jsx)(s.b,{to:"/me",className:"link",children:"Me"}),Object(x.jsx)("div",{className:"line"})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)(s.b,{to:"/me/posts",className:"link",children:"My posts"}),Object(x.jsx)("div",{className:"line"})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)(s.b,{to:"/settings",className:"link",children:"Settings"}),Object(x.jsx)("div",{className:"line"})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("span",{onClick:t,className:"link",children:"Logout"}),Object(x.jsx)("div",{className:"line"})]})]})})]})})},g=a(22);var N=function(){var e=Object(n.useState)("true"===localStorage.getItem("dark")),t=Object(d.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e;localStorage.setItem("dark",String(a)),null===(e=document.getElementById("root"))||void 0===e||e.classList[a?"add":"remove"]("dark")}),[a]),Object(x.jsx)("div",{className:"toggle-dark",onClick:function(e){return function(e){e.preventDefault(),r(!a)}(e)},children:Object(x.jsx)("button",{children:a?Object(x.jsx)(g.b,{}):Object(x.jsx)(g.a,{})})})};var w=function(){var e=Object(n.useContext)(O),t=e.setMe,a=e.me;return Object(n.useEffect)((function(){m.get("/me").then((function(e){t(e.data.user)}))}),[]),Object(x.jsxs)("nav",{className:"nav",children:[Object(x.jsxs)("ul",{className:"links",children:[Object(x.jsx)("li",{children:Object(x.jsx)(s.b,{className:"link",to:"/",children:"Home"})}),(null===a||void 0===a?void 0:a.id)?Object(x.jsx)(p,{}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{children:Object(x.jsx)(s.b,{className:"link",to:"/register",children:"Register"})}),Object(x.jsx)("li",{children:Object(x.jsx)(s.b,{className:"link",to:"/login",children:"Login"})})]})]}),Object(x.jsx)(N,{})]})};var y=function(){var e=Object(i.f)();return Object(x.jsxs)("div",{className:"wrapper",children:[Object(x.jsx)("h1",{children:"Page not found"}),Object(x.jsx)("button",{className:"btn",onClick:function(){e.goBack()},children:"Go Back"})]})};var k=function(){return Object(x.jsx)("div",{children:"home page"})};var S=function(){var e=Object(n.useRef)(null),t=Object(n.useContext)(O).me,a=Object(i.f)(),r=Object(n.useState)(""),c=Object(d.a)(r,2),s=c[0],l=c[1],o=Object(n.useState)(""),b=Object(d.a)(o,2),h=b[0],v=b[1];Object(n.useEffect)((function(){t&&a.push("/me")}),[a,t]);var f=function(){var t=Object(j.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,m.post("/login",{login:s,password:h});case 4:a.push("/me"),location.reload(),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),t.t0.response.data.errors.forEach((function(t){var a,n,r=null===(a=e.current)||void 0===a?void 0:a.querySelector("#".concat(t.field)),c=document.createElement("div");c.classList.add("error"),c.textContent=t.reason,null===(n=r.parentElement)||void 0===n||n.appendChild(c),r.classList.add("border-red"),setTimeout((function(){var e;null===(e=r.parentElement)||void 0===e||e.removeChild(c),r.classList.remove("border-red")}),2500)}));case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsx)("main",{className:"wrapper",children:Object(x.jsx)("div",{className:"form-container",children:Object(x.jsxs)("form",{onSubmit:f,ref:e,children:[Object(x.jsxs)("div",{className:"form-control",children:[Object(x.jsx)("label",{htmlFor:"login",children:"Login"}),Object(x.jsx)("input",{onChange:function(e){return l(e.target.value)},value:s,className:"input",type:"text",id:"login",placeholder:"AwesomeName"})]}),Object(x.jsxs)("div",{className:"form-control",children:[Object(x.jsx)("label",{htmlFor:"password",children:"Password"}),Object(x.jsx)("input",{onChange:function(e){return v(e.target.value)},value:h,className:"input",type:"password",id:"password",placeholder:"my safe password"})]}),Object(x.jsx)("div",{className:"form-control",children:Object(x.jsx)("button",{type:"submit",className:"btn btn-large",children:"Submit"})})]})})})};var C=function(){var e=Object(n.useContext)(O).me;return e?Object(x.jsx)("main",{className:"wrapper",children:Object(x.jsxs)("h1",{children:["Welcome ",e.username,"!"]})}):Object(x.jsxs)("main",{className:"wrapper",children:[Object(x.jsx)("h1",{children:"You are not logged in!"}),Object(x.jsx)(s.b,{className:"btn btn-large no-bg",to:"/login",children:"Do you have an account? Login"}),Object(x.jsx)(s.b,{className:"btn btn-large no-bg",to:"/register",children:"Create your own account! Register"})]})};var E=function(){return Object(x.jsx)("div",{children:"me posts create"})};var B=function(){return Object(x.jsx)("div",{children:"Me Posts"})};var M=function(){return Object(x.jsx)("div",{children:"me posts update"})},A=a(69);var F=function(){var e=Object(n.useRef)(null),t=Object(i.f)(),a=Object(n.useState)(""),r=Object(d.a)(a,2),c=r[0],s=r[1],l=Object(n.useState)(""),o=Object(d.a)(l,2),b=o[0],h=o[1],O=Object(n.useState)(""),v=Object(d.a)(O,2),f=v[0],p=v[1],g=Object(A.a)(["me"]),N=Object(d.a)(g,2)[1],w=function(){var a=Object(j.a)(u.a.mark((function a(n){var r;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.prev=1,a.next=4,m.post("/register",{username:c,email:b,password:f});case 4:r=a.sent,t.push("/me"),location.reload(),N("me",r.data.user),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(1),a.t0.response.data.errors.forEach((function(t){var a,n,r=null===(a=e.current)||void 0===a?void 0:a.querySelector("#".concat(t.field)),c=document.createElement("div");c.classList.add("error"),c.textContent=t.reason,null===(n=r.parentElement)||void 0===n||n.appendChild(c),r.classList.add("border-red"),setTimeout((function(){var e;null===(e=r.parentElement)||void 0===e||e.removeChild(c),r.classList.remove("border-red")}),2500)}));case 14:case"end":return a.stop()}}),a,null,[[1,10]])})));return function(e){return a.apply(this,arguments)}}();return Object(x.jsx)("main",{className:"wrapper",children:Object(x.jsx)("div",{className:"form-container",children:Object(x.jsxs)("form",{onSubmit:w,ref:e,children:[Object(x.jsxs)("div",{className:"form-control",children:[Object(x.jsx)("label",{htmlFor:"username",children:"Username"}),Object(x.jsx)("input",{onChange:function(e){return s(e.target.value)},value:c,className:"input",type:"text",id:"username",placeholder:"my_username"})]}),Object(x.jsxs)("div",{className:"form-control",children:[Object(x.jsx)("label",{htmlFor:"email",children:"Email"}),Object(x.jsx)("input",{onChange:function(e){return h(e.target.value)},value:b,className:"input",type:"email",id:"email",placeholder:"my_email@example.com"})]}),Object(x.jsxs)("div",{className:"form-control",children:[Object(x.jsx)("label",{htmlFor:"password",children:"Password"}),Object(x.jsx)("input",{onChange:function(e){return p(e.target.value)},value:f,className:"input",type:"password",id:"password",placeholder:"my safe password"})]}),Object(x.jsx)("div",{className:"form-control",children:Object(x.jsx)("button",{type:"submit",className:"btn btn-large",children:"Submit"})})]})})})};var L=function(){var e,t,a,r=Object(n.useContext)(O),c=Object(n.useState)((null===(e=r.me)||void 0===e?void 0:e.avatar)||r.defaultAvatar),s=Object(d.a)(c,2),i=s[0],l=s[1],o=Object(n.useState)((null===(t=r.me)||void 0===t?void 0:t.avatar)||""),b=Object(d.a)(o,2),h=b[0],v=b[1],f=Object(n.useState)(""),p=Object(d.a)(f,2),g=p[0],N=p[1],w=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.post("/me/avatar",{avatar:i});case 2:t=e.sent,r.setMe(t.data.user);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){var e,t;l((null===(e=r.me)||void 0===e?void 0:e.avatar)||r.defaultAvatar),v((null===(t=r.me)||void 0===t?void 0:t.avatar)||"")}),[r.defaultAvatar,r.me]),Object(n.useEffect)((function(){Object(j.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(h);case 3:return t=e.sent,e.next=6,t.blob();case 6:(a=e.sent).size>1e5?(N("Select a smaller image"),setTimeout((function(){return N("")}),3e3),l(r.defaultAvatar)):a.type.startsWith("image/")?l(h):l(r.defaultAvatar),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),l(r.defaultAvatar);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}),[r.defaultAvatar,h]),Object(x.jsxs)("div",{children:[Object(x.jsx)("h2",{children:"Change your avatar"}),Object(x.jsxs)("div",{className:"border-left",children:[Object(x.jsx)("h3",{children:"Preview"}),Object(x.jsx)("div",{className:"profile-picture pic-large",children:Object(x.jsx)("img",{src:i,alt:"your profile"})}),Object(x.jsxs)("div",{className:"settings",children:[Object(x.jsx)("h4",{children:Object(x.jsx)("label",{htmlFor:"url",children:"Paste an url here"})}),Object(x.jsx)("input",{type:"text",id:"url",placeholder:"https://images.unsplash.com/photo-1602694866292-c0597a4452b2?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=634&q=80",onChange:function(e){return v(e.target.value)},value:h})]}),g&&Object(x.jsx)("span",{className:"error btn-large",children:g}),i===r.defaultAvatar||i===(null===(a=r.me)||void 0===a?void 0:a.avatar)?Object(x.jsx)("button",{title:"missing image",disabled:!0,className:"btn btn-large",children:"Set"}):Object(x.jsx)("button",{onClick:w,className:"btn btn-large",children:"Set"})]})]})};var D=function(){var e,t,a,r=Object(n.useContext)(O),c=Object(n.useState)((null===(e=r.me)||void 0===e?void 0:e.banner)||r.defaultBanner),s=Object(d.a)(c,2),i=s[0],l=s[1],o=Object(n.useState)((null===(t=r.me)||void 0===t?void 0:t.banner)||""),b=Object(d.a)(o,2),h=b[0],v=b[1],f=Object(n.useState)(""),p=Object(d.a)(f,2),g=p[0],N=p[1],w=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.post("/me/banner",{banner:i});case 2:t=e.sent,console.log(t.data),r.setMe(t.data.user);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){var e,t;l((null===(e=r.me)||void 0===e?void 0:e.banner)||r.defaultBanner),v((null===(t=r.me)||void 0===t?void 0:t.banner)||"")}),[r.defaultBanner,r.me]),Object(n.useEffect)((function(){Object(j.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(h);case 3:return t=e.sent,e.next=6,t.blob();case 6:(a=e.sent).size>1e5?(N("Select a smaller image"),setTimeout((function(){return N("")}),3e3),l(r.defaultBanner)):a.type.startsWith("image/")?l(h):l(r.defaultBanner),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),l(r.defaultBanner);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}),[r.defaultBanner,h]),Object(x.jsxs)("div",{children:[Object(x.jsx)("h2",{children:"Change your banner"}),Object(x.jsxs)("div",{className:"border-left",children:[Object(x.jsx)("h3",{children:"Preview"}),Object(x.jsx)("div",{className:"profile-banner",children:Object(x.jsx)("img",{src:i,alt:"your banner"})}),Object(x.jsxs)("div",{className:"settings",children:[Object(x.jsx)("h4",{children:Object(x.jsx)("label",{htmlFor:"url",children:"Paste an url here"})}),Object(x.jsx)("input",{type:"text",id:"url",placeholder:"https://images.unsplash.com/photo-1622988869811-a4f3d3fe5441?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=634&q=80",onChange:function(e){return v(e.target.value)},value:h})]}),g&&Object(x.jsx)("span",{className:"error btn-large",children:g}),i===r.defaultBanner||i===(null===(a=r.me)||void 0===a?void 0:a.banner)?Object(x.jsx)("button",{title:"missing image",disabled:!0,className:"btn btn-large",children:"Set"}):Object(x.jsx)("button",{onClick:w,className:"btn btn-large",children:"Set"})]})]})};var H=function(){var e,t,a=Object(n.useContext)(O),r=Object(n.useState)((null===(e=a.me)||void 0===e?void 0:e.username)||""),c=Object(d.a)(r,2),s=c[0],i=c[1],l=Object(n.useState)(""),o=Object(d.a)(l,2),b=o[0],h=o[1];Object(n.useEffect)((function(){var e;i((null===(e=a.me)||void 0===e?void 0:e.username)||"")}),[a]);var v=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.post("/me/username",{username:s});case 3:t=e.sent,console.log(t.data),a.setMe(t.data.user),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),h(e.t0.response.data.errors.map((function(e){return e.reason})).join(", ")),setTimeout((function(){return h("")}),3e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(x.jsxs)("div",{children:[Object(x.jsx)("h2",{children:"Change your username"}),Object(x.jsxs)("div",{className:"border-left",children:[Object(x.jsxs)("div",{className:"settings",children:[Object(x.jsx)("h4",{children:Object(x.jsx)("label",{htmlFor:"name",children:"New username"})}),Object(x.jsx)("input",{type:"text",id:"name",onChange:function(e){return i(e.target.value)},value:s})]}),b&&Object(x.jsx)("span",{className:"error btn-large",children:b}),s===(null===(t=a.me)||void 0===t?void 0:t.username)||""===s?Object(x.jsx)("button",{title:"missing username",disabled:!0,className:"btn btn-large",children:"Set"}):Object(x.jsx)("button",{onClick:v,className:"btn btn-large",children:"Set"})]})]})};var P=function(){return Object(x.jsxs)("main",{className:"wrapper",children:[Object(x.jsx)(H,{}),Object(x.jsx)(L,{}),Object(x.jsx)(D,{})]})};var G=function(){var e=Object(i.g)().user_id;return Object(x.jsxs)("div",{children:["User ",e," Page"]})};var T=function(){return Object(x.jsxs)(s.a,{children:[Object(x.jsx)(w,{}),Object(x.jsxs)(i.c,{children:[Object(x.jsx)(i.a,{exact:!0,path:"/",children:Object(x.jsx)(k,{})}),Object(x.jsx)(i.a,{exact:!0,path:"/login",children:Object(x.jsx)(S,{})}),Object(x.jsx)(i.a,{exact:!0,path:"/register",children:Object(x.jsx)(F,{})}),Object(x.jsx)(i.a,{exact:!0,path:"/me",children:Object(x.jsx)(C,{})}),Object(x.jsx)(i.a,{exact:!0,path:"/me/posts",children:Object(x.jsx)(B,{})}),Object(x.jsx)(i.a,{exact:!0,path:"/me/posts/create",children:Object(x.jsx)(E,{})}),Object(x.jsx)(i.a,{exact:!0,path:"/me/posts/update/:post_id",children:Object(x.jsx)(M,{})}),Object(x.jsx)(i.a,{exact:!0,path:"/users/:user_id",children:Object(x.jsx)(G,{})}),Object(x.jsx)(i.a,{exact:!0,path:"/settings",children:Object(x.jsx)(P,{})}),Object(x.jsx)(i.a,{path:"*",children:Object(x.jsx)(y,{})})]})]})},_=(a(67),a(70));c.a.render(Object(x.jsx)(_.a,{children:Object(x.jsx)(f,{children:Object(x.jsx)(T,{})})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.8f35d3b2.chunk.js.map